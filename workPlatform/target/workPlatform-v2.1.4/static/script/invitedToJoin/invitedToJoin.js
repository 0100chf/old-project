$(function(){var h=$("#login_form"),a=$("#login_user_input",h),d=$("#login_password_input",h),b=$("#agree_btn",h),f=$("#login_agree_btn",h),g=new InputValidate(a,true,30,0,"email",null),e=new InputValidate(d,true,30,0,"",null);var c=$("h5#orgName").text();if(!isLogin&&f.length>=1){f.on("click",function(i){EventUtil.preventDefault(i);var k={type:"nologin",code:code,account:a.val(),password:hex_hmac_md5(a.val(),d.val())},j=this;$(j).prop("disabled",true);$.ajax({type:"post",url:context+"/user/agreetojoinorg.htm",data:k,beforeSend:function(){if(!g.checkValidate()||!e.checkValidate()){$(j).prop("disabled",false);return false}return true},success:function(l){if(l&&l.success){window.location=context+"/login/tojoinsuccess.htm?name="+c}else{if(l&&!l.success){if(l.errorType=="error_1"){window.location=context+"/login/tojoinfailure.htm";return}if(l.errorType=="error_2"){window.location=context+"/login/userexistOrg.htm?name="+c;return false}layer.alert(l.errormsg,1)}else{layer.alert("请求失败",1)}}$(j).prop("disabled",false)},error:function(){layer.alert("请求失败",1);$(j).prop("disabled",false)}})})}if(isLogin&&b.length>=1){b.on("click",function(i){EventUtil.preventDefault(i);var j=this;$(j).prop("disabled",true);$.ajax({type:"post",url:context+"/login/agreetojoinorg.htm",data:{code:code,type:"haslogin"},success:function(k){if(k&&k.success){window.location=context+"/login/tojoinsuccess.htm?name="+c}else{if(k&&!k.success){if(k.errorType=="error_1"){window.location=context+"/login/tojoinfailure.htm";return}if(k.errorType=="error_2"){window.location=context+"/login/userexistOrg.htm?name="+c;return false}layer.alert(k.errormsg,1)}else{layer.alert("请求失败",1)}}$(j).prop("disabled",false)},error:function(){layer.alert("请求失败",1);$(j).prop("disabled",false)}})})}});
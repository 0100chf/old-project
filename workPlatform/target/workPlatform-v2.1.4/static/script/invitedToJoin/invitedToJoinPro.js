$(function(){var h=$("#login_form_pro"),a=$("#login_user_input_pro",h),d=$("#login_password_input_pro",h),c=$("#agree_btn_pro",h),f=$("#login_agree_btn_pro",h),g=new InputValidate(a,true,30,0,"email",null),e=new InputValidate(d,true,30,0,"",null);var b=$("h5#projectname").html();if(!isLogin&&f.length>=1){f.on("click",function(i){EventUtil.preventDefault(i);var k={type:"nologin",code:code,account:a.val(),password:hex_hmac_md5(a.val(),d.val())},j=this;$(j).prop("disabled",true);$.ajax({type:"post",url:context+"/user/agreetojoinpro.htm",data:k,beforeSend:function(){if(!g.checkValidate()||!e.checkValidate()){$(j).prop("disabled",false);return false}return true},success:function(l){if(l&&l.success){window.location=context+"/login/tojoinprosuccess.htm?name="+b}else{if(l&&!l.success){if(l.errorType=="error_1"){window.location=context+"/login/userexistpro.htm?name="+b;return}else{if(l.errorType=="error_0"){window.location=context+"/login/userNotBelongOrg.htm?name="+b;return}else{if(l.errorType=="error_2"||l.errorType=="error_3"){layer.alert(l.errormsg,2);window.location=context+"/login/tojoinfailure.htm";return}}}layer.alert(l.errormsg,1)}else{layer.alert("请求失败",1)}}$(j).prop("disabled",false)},error:function(){layer.alert("请求失败",1);$(j).prop("disabled",false)}})})}if(isLogin&&c.length>=1){c.on("click",function(i){EventUtil.preventDefault(i);var j=this;$(j).prop("disabled",true);$.ajax({type:"post",url:context+"/login/agreetojoinpro.htm",data:{code:code,type:"haslogin"},success:function(k){if(k&&k.success){window.location=context+"/login/tojoinprosuccess.htm?name="+b}else{if(k&&!k.success){if(k.errorType=="error_1"){window.location=context+"/login/userexistpro.htm?name="+b;return}else{if(k.errorType=="error_0"){window.location=context+"/login/userNotBelongOrg.htm?name="+b;return}else{if(k.errorType=="error_2"||k.errorType=="error_3"){layer.alert(k.errormsg,2);window.location=context+"/login/tojoinfailure.htm";return}}}layer.alert(k.errormsg,2)}else{layer.alert("请求失败",1)}}$(j).prop("disabled",false)},error:function(){layer.alert("请求失败",1);$(j).prop("disabled",false)}})})}});
$(function(){var h=$("#register_form"),b=$("#register_username_input",h),f=$("#register_name_input",h),c=$("#register_password_input",h),d=$("#register_confirmpwd_input",h),a=$("#is_createorganize_checkbox",h),k=$("#organize_name_input",h),e=$("#register_btn",h);var i=new InputValidate(b,true,30,0,"email",null),m=new InputValidate(f,true,30,0,"",null),g=new InputValidate(c,true,30,0,"password",null),l=new InputValidate(d,true,30,0,"password",null,c),j=new InputValidate(k,true,30,0,"",null);a.on("click",function(){var n=$(this);if(n.find("i.tohide").length>0){n.find("i").removeClass("tohide");k.removeClass("tohide error").val("")}else{n.find("i").addClass("tohide");k.addClass("tohide")}});e.on("click",function(n){EventUtil.preventDefault(n);var q={},p=h.formToArray(),o=this;$(o).prop("disabled",true);$.each(p,function(r,s){q[s.name]=s.value});q.password=hex_hmac_md5(q.account,q.password);$.ajax({type:"post",url:context+"/user/registerIn.htm",data:q,beforeSend:function(){if(!i.checkValidate()||!m.checkValidate()||!g.checkValidate()||!l.checkValidate()||(a.find("i.tohide").length<=0&&!j.checkValidate())){$(o).prop("disabled",false);return false}return true},success:function(r){if(r&&r.success){window.location=context+"/user/registerSuccess.htm?account="+b.val()}else{if(r&&!r.success&&r.errormsg){layer.alert(r.errormsg,1)}else{layer.alert("请求失败",1)}}$(o).prop("disabled",false)},error:function(){layer.alert("请求失败",1);$(o).prop("disabled",false)}})})});
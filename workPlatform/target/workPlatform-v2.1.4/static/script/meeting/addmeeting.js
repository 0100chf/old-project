define(["script/common/dialogAlert","jqueryForm","jquery","layer","my97"],function(b){var a={init:function(d,c){this.panel=d;this.setEvent();this.valiArray={};this.addMeetingViewInit();this.callback=c},setEvent:function(){var c=this;this.panel.on("click","button.submit_btn",function(f){var e=$(this);e.prop("disabled",true);var d={beforeSubmit:function(){var g=false;$.each(c.valiArray,function(h,i){if(i&&!i.checkValidate()){g=true;return false}});if(g){e.prop("disabled",false);return false}return true},success:function(g){if(g&&g.success){layer.alert("信息保存成功",1,"信息",function(h){layer.close(h)});c.callback(g.resultData)}else{if(g&&!g.success&&g.errormsg){b.alert(g.errormsg,5)}else{layer.alert("请求失败",1)}}e.prop("disabled",false)},error:function(){layer.alert("请求失败",1);e.prop("disabled",false)}};e.closest("form.meeting_form").ajaxSubmit(d);return false});c.panel.on("click",'input[name="beginTimeString"]',function(){var e=new Date();var d=e.toLocaleDateString()+" "+e.getHours()+"时"+e.getMinutes()+"分"+e.getSeconds()+"秒";var f=$(this);WdatePicker({errDealMode:1,dateFmt:"yyyy年MM月dd日  HH时mm分",qsEnabled:false,isShowOK:false,minDate:d,autoPickDate:true,onclearing:function(){c.panel.find(".updateEndDate").val("");$dp.hide();sendData.value=null;return true}});return false})},addMeetingViewInit:function(){var e=this;var h=this.panel.find('form.meeting_form input[name="title"]'),c=this.panel.find('form.meeting_form input[name="beginTimeString"]'),g=this.panel.find('form.meeting_form input[name="place"]'),f=this.panel.find('form.meeting_form textarea[name="detail"]'),d=this.panel.find('form.meeting_form textarea[name="record"]');e.valiArray.title=new InputValidate(h,true,30);e.valiArray.beginTime=new InputValidate(c,true);e.valiArray.place=new InputValidate(g,false,30);e.valiArray.detail=new InputValidate(f,false,180);e.valiArray.record=new InputValidate(d,false,3500)}};return a});